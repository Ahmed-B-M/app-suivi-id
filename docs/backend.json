{
  "entities": {
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task fetched from the Urbantz API.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the task."
        },
        "hubId": {
          "type": "string",
          "description": "Reference to the Hub this task is associated with. (Relationship: Hub 1:N Task)"
        },
        "createdAt": {
          "type": "string",
          "description": "Date and time when the task was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Date and time when the task was last updated.",
          "format": "date-time"
        },
        "plannedArrival": {
          "type": "string",
          "description": "Planned arrival time for the task.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "Description of the task."
        },
        "status": {
          "type": "string",
          "description": "Status of the task (e.g., 'pending', 'completed')."
        },
        "priority": {
          "type": "number",
          "description": "Priority of the task."
        },
        "customerId": {
          "type": "string",
          "description": "Reference to the Customer associated with the task. (Relationship: Customer 1:N Task)"
        },
        "tags": {
          "type": "array",
          "description": "Tags associates to the task",
          "items": {
            "type": "string"
          }
        },
        "rating": {
          "type": "number",
          "description": "The rating given to a task, typically from 0 to 5."
        },
        "notationLivreur": {
          "type": "number",
          "description": "The rating given by the delivery person."
        },
        "commentaires": {
          "type": "string",
          "description": "Comments associated with the task."
        }
      },
      "required": [
        "id",
        "hubId",
        "createdAt",
        "updatedAt",
        "status",
        "priority"
      ]
    },
    "Round": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Round",
      "type": "object",
      "description": "Represents a round fetched from the Urbantz API.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the round."
        },
        "name": {
          "type": "string",
          "description": "Name of the round."
        },
        "status": {
          "type": "string",
          "description": "Status of the round."
        },
        "date": {
          "type": "string",
          "format": "date-time",
          "description": "Date of the round."
        }
      },
      "required": [
        "id",
        "name",
        "status",
        "date"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/tasks/{taskId}",
        "definition": {
          "entityName": "Task",
          "schema": {
            "$ref": "#/backend/entities/Task"
          },
          "description": "Stores task data fetched from the Urbantz API. Includes `hubId` and `customerId` to reference related entities.",
          "params": [
            {
              "name": "taskId",
              "description": "Unique identifier for the task."
            }
          ]
        }
      },
      {
        "path": "/rounds/{roundId}",
        "definition": {
          "entityName": "Round",
          "schema": {
            "$ref": "#/backend/entities/Round"
          },
          "description": "Stores round data fetched from the Urbantz API.",
          "params": [
            {
              "name": "roundId",
              "description": "Unique identifier for the round."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to store data fetched from the Urbantz API, focusing on Tasks and Rounds. A top-level collection for each entity is used. This design prioritizes simplicity for data retrieval and avoids nested collections, which simplifies querying and rule creation.\n\nAuthorization Independence is achieved because there is no authorization specified on this data. If authorization was needed, for example, if some tasks are private to certain users. The `tasks` collection would need to include denormalized authorization data (like a `members` map or `ownerId`) to avoid `get()` calls in security rules.\n\nQAPs (Rules are not Filters): The flat structure of each collection ensures secure list operations. Security rules can be applied to each collection based on the properties within the documents, without requiring filtering based on parent document data."
  }
}
