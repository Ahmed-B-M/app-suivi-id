/**
 * @fileoverview Firestore Security Rules for Urbantz API Data.
 *
 * Core Philosophy:
 * This ruleset is in prototyping mode. It prioritizes a flexible data structure to allow for rapid iteration but enforces a strong default-deny authorization model.  All collections are currently publicly readable but writes are disabled, pending the implementation of a proper authorization strategy.
 *
 * Data Structure:
 * The Firestore database consists of three top-level collections: `hubs`, `customers`, and `tasks`. Each collection contains documents representing data fetched from the Urbantz API.
 *
 * Key Security Decisions:
 * - Public Read Access: All data is currently readable by anyone (authenticated or unauthenticated) to facilitate prototyping.
 * - Write Restrictions: All write operations are currently denied. This will be updated with an appropriate authorization strategy in a subsequent iteration.
 * - No User Listing: Listing of user documents is explicitly disallowed.
 *
 * Denormalization for Authorization:
 * The reasoning section mentions that If authorization was needed denormalized data (like a `members` map or `ownerId`) would be required. This has not been implemented.
 *
 * Structural Segregation:
 * There is no structural segregation.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows read access to hubs data. Write access is denied.
     * @path /hubs/{hubId}
     * @allow (get, list) if true;
     * @deny (create, update, delete) always.
     * @principle Public read access for prototyping; writes disabled for security.
     */
    match /hubs/{hubId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows read access to customers data. Write access is denied.
     * @path /customers/{customerId}
     * @allow (get, list) if true;
     * @deny (create, update, delete) always.
     * @principle Public read access for prototyping; writes disabled for security.
     */
    match /customers/{customerId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows read access to tasks data. Write access is denied.
     * @path /tasks/{taskId}
     * @allow (get, list) if true;
     * @deny (create, update, delete) always.
     * @principle Public read access for prototyping; writes disabled for security.
     */
    match /tasks/{taskId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

      /**
       * @description Denies listing of the /rounds collection.
       * @path /rounds
       * @deny (list) Always.
       * @principle Listing of this data is prohibited.
       */
      match /rounds {
        allow get, create, update, delete: if false;
        allow list: if false;
    }
  }
}