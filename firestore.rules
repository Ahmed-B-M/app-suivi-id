/**
 * @fileoverview Firestore Security Rules for Prototyping.
 *
 * Core Philosophy:
 * This ruleset is in prototyping mode. It assumes data is public.
 *
 * Data Structure:
 * - /tasks/{taskId}: Stores task data fetched from the Urbantz API.
 * - /rounds/{roundId}: Stores round data fetched from the Urbantz API.
 *
 * Key Security Decisions:
 * - Data is publicly readable.
 * - Data can be created, updated, and deleted by any authenticated user.
 *
 * Denormalization for Authorization:
 * - Not applicable in this case, as data is public and writable by authenticated users.
 *
 * Structural Segregation:
 * - Not applicable, as there's no separation between private and public data in the current data model.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Grants public read access to tasks and allows any authenticated user to create, update, and delete tasks.
     * @path /tasks/{taskId}
     * @allow (get, list): Public read access.
     * @allow (create, update, delete): Any authenticated user.
     * @deny (create, update, delete): Unauthenticated users.
     * @principle Allows public reads and authenticated writes during prototyping.
     */
    match /tasks/{taskId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Grants public read access to rounds and allows any authenticated user to create, update, and delete rounds.
     * @path /rounds/{roundId}
     * @allow (get, list): Public read access.
     * @allow (create, update, delete): Any authenticated user.
     * @deny (create, update, delete): Unauthenticated users.
     * @principle Allows public reads and authenticated writes during prototyping.
     */
    match /rounds/{roundId} {
      allow get, list: if true;
      allow create, update, delete: if isSignedIn();
    }

    // Helper function to check if a user is signed in
    function isSignedIn() {
      return request.auth != null;
    }
  }
}