/**
 * @fileoverview Firestore Security Rules for the Urbantz API data model.
 *
 * Core Philosophy:
 * This ruleset provides public read access to all data while restricting all write access.
 * This allows for easy data exploration and integration during the prototyping phase.
 *
 * Data Structure:
 * The Firestore database consists of top-level collections for `tasks`, `rounds`, `categorized_comments`, `nps_data`, `processed_nps_verbatims`, `action_notes`, `action_notes_depot`, and `users`.
 * Each document in these collections is identified by a unique ID (e.g., `taskId`, `roundId`, `date`).
 *
 * Key Security Decisions:
 * - Read access is public for all collections.
 * - All write operations (create, update, delete) are explicitly denied.
 *
 * Authorization Independence:
 * This ruleset does not implement authorization checks, as the reasoning in `backend.json` specifies an intent for authorization independence.
 * This means that write access is not tied to any user roles or identities.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows anyone to read user profile information, but restricts all writes.
     * @path /users/{userId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /users/{userId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read task data, but restricts all writes.
     * @path /tasks/{taskId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /tasks/{taskId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read round data, but restricts all writes.
     * @path /rounds/{roundId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /rounds/{roundId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read categorized comments, but restricts all writes.
     * @path /categorized_comments/{taskId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /categorized_comments/{taskId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read NPS data, but restricts all writes.
     * @path /nps_data/{date}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /nps_data/{date} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read processed NPS verbatims, but restricts all writes.
     * @path /processed_nps_verbatims/{taskId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /processed_nps_verbatims/{taskId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read action notes, but restricts all writes.
     * @path /action_notes/{date}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /action_notes/{date} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }

    /**
     * @description Allows anyone to read depot action notes, but restricts all writes.
     * @path /action_notes_depot/{depotDateId}
     * @allow (get, list): if true;
     * @deny (create, update, delete): Always.
     * @principle Public read, no writes.
     */
    match /action_notes_depot/{depotDateId} {
      allow get, list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
  }
}